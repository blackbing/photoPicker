/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
((function(){define("photoPickerModel",["module"],function(a){var b,c;return c=a.id,b=Backbone.Model.extend({initialize:function(){return console.log(c,"initialize")}}),b})})).call(this),function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d=typeof location!="undefined"&&location.href,e=d&&location.protocol&&location.protocol.replace(/\:/,""),f=d&&location.hostname,g=d&&(location.port||void 0),h=[];define("text",[],function(){var l,m,s;return typeof window!="undefined"&&window.navigator&&window.document?m=function(a,b){var c=l.createXhr();c.open("GET",a,!0),c.onreadystatechange=function(){c.readyState===4&&b(c.responseText)},c.send(null)}:typeof process!="undefined"&&process.versions&&process.versions.node?(s=require.nodeRequire("fs"),m=function(a,b){var c=s.readFileSync(a,"utf8");c.indexOf("ï»¿")===0&&(c=c.substring(1)),b(c)}):typeof Packages!="undefined"&&(m=function(a,b){var c=new java.io.File(a),d=java.lang.System.getProperty("line.separator"),c=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(c),"utf-8")),e,f,g="";try{e=new java.lang.StringBuffer,(f=c.readLine())&&f.length()&&f.charAt(0)===65279&&(f=f.substring(1));for(e.append(f);(f=c.readLine())!==null;)e.append(d),e.append(f);g=String(e.toString())}finally{c.close()}b(g)}),l={version:"1.0.7",strip:function(a){if(a){var a=a.replace(b,""),d=a.match(c);d&&(a=d[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var b,c,d;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(c=0;c<3;c++){d=a[c];try{b=new ActiveXObject(d)}catch(e){}if(b){a=[d];break}}if(!b)throw Error("createXhr(): XMLHttpRequest not available");return b},get:m,parseName:function(a){var b=!1,c=a.indexOf("."),d=a.substring(0,c),a=a.substring(c+1,a.length),c=a.indexOf("!");return c!==-1&&(b=a.substring(c+1,a.length),b=b==="strip",a=a.substring(0,c)),{moduleName:d,ext:a,strip:b}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,b,c,d){var e=l.xdRegExp.exec(a),f;return e?(a=e[2],e=e[3],e=e.split(":"),f=e[1],e=e[0],(!a||a===b)&&(!e||e===c)&&(!f&&!e||f===d)):!0},finishLoad:function(a,b,c,d,e){c=b?l.strip(c):c,e.isBuild&&(h[a]=c),d(c)},load:function(a,b,c,h){if(h.isBuild&&!h.inlineText)c();else{var j=l.parseName(a),k=j.moduleName+"."+j.ext,m=b.toUrl(k),n=h&&h.text&&h.text.useXhr||l.useXhr;!d||n(m,e,f,g)?l.get(m,function(b){l.finishLoad(a,j.strip,b,c,h)}):b([k],function(a){l.finishLoad(j.moduleName+"."+j.ext,j.strip,a,c,h)})}},write:function(a,b,c){if(b in h){var d=l.jsEscape(h[b]);c.asModule(a+"!"+b,"define(function () { return '"+d+"';});\n")}},writeFile:function(a,b,c,d,e){var b=l.parseName(b),f=b.moduleName+"."+b.ext,g=c.toUrl(b.moduleName+"."+b.ext)+".js";l.load(f,c,function(){var b=function(a){return d(g,a)};b.asModule=function(a,b){return d.asModule(a,g,b)},l.write(a,f,b,e)},e)}}})}(),define("text!../template/photoPicker.hbs",[],function(){return'  <ul>\n  {{#contents}}\n  <li class=""><img src="{{src}}"></li>\n  {{/contents}}\n  </ul>\n'}),function(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}(jQuery),define("jquery-mousewheel",function(){}),function(a){function b(b,d){this.el=a(b),this.options=d||{},this.padding=undefined==this.options.padding?2:this.options.padding,this.inner=this.el.find(".antiscroll-inner"),this.inner.css({width:"+="+f(),height:"+="+f()});if(this.options.forceHorizontal||this.inner.get(0).scrollWidth>this.el.width())this.horizontal=new c.Horizontal(this);if(this.options.forceVertical||this.inner.get(0).scrollHeight>this.el.height())this.vertical=new c.Vertical(this)}function c(b){this.pane=b,this.pane.el.append(this.el),this.innerEl=this.pane.inner.get(0),this.dragging=!1,this.enter=!1,this.shown=!1,this.pane.el.mouseenter(a.proxy(this,"mouseenter")),this.pane.el.mouseleave(a.proxy(this,"mouseleave")),this.el.mousedown(a.proxy(this,"mousedown")),this.pane.inner.scroll(a.proxy(this,"scroll")),this.pane.inner.bind("mousewheel",a.proxy(this,"mousewheel"));var c=this.pane.options.initialDisplay;c!==!1&&(this.show(),this.pane.options.autoHide&&(this.hiding=setTimeout(a.proxy(this,"hide"),parseInt(c,10)||3e3)))}function d(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c}function f(){if(!e){var b=a('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');a("body").append(b);var c=a("div",b).innerWidth();b.css("overflow-y","scroll");var d=a("div",b).innerWidth();a(b).remove(),e=c-d}return e}a.fn.antiscroll=function(b){return this.each(function(){a(this).data("antiscroll")&&a(this).data("antiscroll").destroy(),a(this).data("antiscroll",new a.Antiscroll(this,b))})},a.Antiscroll=b,b.prototype.destroy=function(){return this.horizontal&&this.horizontal.destroy(),this.vertical&&this.vertical.destroy(),this},c.prototype.destroy=function(){return this.el.remove(),this},c.prototype.mouseenter=function(){this.enter=!0,this.show()},c.prototype.mouseleave=function(){this.enter=!1,this.dragging||this.pane.options.autoHide&&this.hide()},c.prototype.scroll=function(){this.shown||(this.show(),!this.enter&&!this.dragging&&this.pane.options.autoHide&&(this.hiding=setTimeout(a.proxy(this,"hide"),1500))),this.update()},c.prototype.mousedown=function(b){b.preventDefault(),this.dragging=!0,this.startPageY=b.pageY-parseInt(this.el.css("top"),10),this.startPageX=b.pageX-parseInt(this.el.css("left"),10),document.onselectstart=function(){return!1};var c=this.pane,d=a.proxy(this,"mousemove"),e=this;a(document).mousemove(d).mouseup(function(){e.dragging=!1,document.onselectstart=null,a(document).unbind("mousemove",d),e.enter||e.hide()})},c.prototype.show=function(a){!this.shown&&this.update()&&(this.el.addClass("antiscroll-scrollbar-shown"),this.hiding&&(clearTimeout(this.hiding),this.hiding=null),this.shown=!0)},c.prototype.hide=function(){this.shown&&(this.el.removeClass("antiscroll-scrollbar-shown"),this.shown=!1)},c.Horizontal=function(b){this.el=a('<div class="antiscroll-scrollbar antiscroll-scrollbar-horizontal">'),c.call(this,b)},d(c.Horizontal,c),c.Horizontal.prototype.update=function(){var a=this.pane.el.width(),b=a-this.pane.padding*2,c=this.pane.inner.get(0);return this.el.css("width",b*a/c.scrollWidth).css("left",b*c.scrollLeft/c.scrollWidth),a<c.scrollWidth},c.Horizontal.prototype.mousemove=function(a){var b=this.pane.el.width()-this.pane.padding*2,c=a.pageX-this.startPageX,d=this.el.width(),e=this.pane.inner.get(0),f=Math.min(Math.max(c,0),b-d);e.scrollLeft=(e.scrollWidth-this.pane.el.width())*f/(b-d)},c.Horizontal.prototype.mousewheel=function(a,b,c,d){if(c<0&&0==this.pane.inner.get(0).scrollLeft||c>0&&this.innerEl.scrollLeft+this.pane.el.width()==this.innerEl.scrollWidth)return a.preventDefault(),!1},c.Vertical=function(b){this.el=a('<div class="antiscroll-scrollbar antiscroll-scrollbar-vertical">'),c.call(this,b)},d(c.Vertical,c),c.Vertical.prototype.update=function(){var a=this.pane.el.height(),b=a-this.pane.padding*2,c=this.innerEl;return this.el.css("height",b*a/c.scrollHeight).css("top",b*c.scrollTop/c.scrollHeight),a<c.scrollHeight},c.Vertical.prototype.mousemove=function(a){var b=this.pane.el.height(),c=b-this.pane.padding*2,d=a.pageY-this.startPageY,e=this.el.height(),f=this.innerEl,g=Math.min(Math.max(d,0),c-e);f.scrollTop=(f.scrollHeight-b)*g/(c-e)},c.Vertical.prototype.mousewheel=function(a,b,c,d){if(d>0&&0==this.innerEl.scrollTop||d<0&&this.innerEl.scrollTop+this.pane.el.height()==this.innerEl.scrollHeight)return a.preventDefault(),!1};var e}(jQuery),define("antiscroll",function(){}),define("vender/antiscroll/scrollbar",["jquery-mousewheel","antiscroll"],function(){$.fn.scrollbar=function(a){return a=a||{},$(this).each(function(){if($.data(this,"HTC.scrollbar"))return;$.data(this,"HTC.scrollbar","true");var b=$('<div class="box-wrap antiscroll-wrap"><div class="box"><div class="antiscroll-inner"></div></div></div>'),c=$('<div class="box-inner"></div>'),d=$(this),e=d.css("float"),f=d.outerWidth(),g=d.outerHeight(),h=d.css("position"),i=d.css("left"),j=d.css("top");d.css({width:"auto",height:"auto",left:"auto",top:"auto",position:"static"}).after(b),c.append(d),b.css({"float":e,left:i,top:j}).find(".box").css({width:f,height:g}).end().find(".antiscroll-inner").css({width:f,height:g}).append(c).end().antiscroll(a),c.width()!==f&&b.find(".antiscroll-inner").css({width:2*f-c.width(),height:g+f-c.width()}),a.showShadow&&b.find(".antiscroll-inner").scroll(function(){this.scrollHeight<=this.scrollTop+this.offsetHeight?$(this).removeClass("indicator"):$(this).addClass("indicator")}).trigger("scroll")})}}),function(){define("photoPickerView",["module","photoPickerModel","text!../template/photoPicker.hbs","vender/antiscroll/scrollbar"],function(a,b,c){var d,e;return e=a.id,d=Backbone.View.extend({options:{id:"photoPicker",width:220,height:200},initialize:function(){var a;return this.model=new b,a=this.getTemplate(),this.$el.append(a)},events:{"click li":"selectPhoto"},selectPhoto:function(a){var b,c,d;return b=$(a.currentTarget),$("#"+this.options.id+" li.selected").removeClass("selected"),b.addClass("selected"),d=this.$("li").index(b),c=this.options.thumbnails.contents[d],this.model.set("selected",c),this.remove()},getTemplate:function(){var a,b,d;return b=this.options.thumbnails,d=Mustache.render(c,b),a=$(d),a},remove:function(){return console.log("remove"),this.$el.data("antiscroll-wrap")?this.$el.detach().data("antiscroll-wrap").remove():this.$el.detach()},render:function(){return console.log("render"),$("body").append(this.$el),this.$el.css({width:this.options.width,height:this.options.height}).scrollbar({forceVertical:!0,showShadow:!0}),this.$el.data("HTC.scrollbar",!1),this.$el.data("antiscroll-wrap",this.$el.closest(".antiscroll-wrap")),console.log("antiscroll"),this}}),d})}.call(this),function(){define("photoPicker",["photoPickerView"],function(a){var b;return b=function(){function b(b){this.view=new a(b),this.model=this.view.model}return b.prototype.show=function(){return this.view.render()},b.prototype.hide=function(){return this.view.remove(),console.log("hide")},b}(),b})}.call(this),function(){define("jquery.photoPicker",["photoPicker"],function(a){var b,c,d,e;return d=null,b=$('<div id="photoPicker" />'),c=function(c){var f;return f=jQuery.extend(c,{el:b}),d=new a(f),d.model.bind("change:selected",function(a,b,c){var d;console.log("change:selected",arguments),d=b.src;if(e)return e.attr("src",d)})},e=null,jQuery.fn.photoPicker=function(a){var b;return d||c.apply(this,arguments),console.log("fn",d),b=this,console.log(b),b.on("click",function(a){return console.log("click",a.currentTarget),d.show(),e=$(a.currentTarget),a.stopPropagation()}),$(document).on("click",function(a){var b;b=$(a.target);if(!b.closest("#photoPicker").length)return d.hide()})}})}.call(this),function(){define("data/thumbnailData",[],function(){var a;return a={contents:[{src:"http://www.mathiaspoulsen.com/wp-content/uploads/2011/10/Document-Write-icon.png"},{src:"http://www.mathiaspoulsen.com/wp-content/uploads/2011/10/Zoom-icon.png"},{src:"http://www.mathiaspoulsen.com/wp-content/uploads/2011/10/Chat-icon.png"},{src:"http://www.mathiaspoulsen.com/wp-content/uploads/2011/10/User-Group-icon.png"},{src:"http://www.mathiaspoulsen.com/wp-content/uploads/2011/10/social-twitter-box-blue-icon1.png"},{src:"http://www.mathiaspoulsen.com/wp-content/uploads/2011/10/Mail-icon.png"}]}})}.call(this),function(){require(["jquery.photoPicker","data/thumbnailData"],function(a,b){return console.log("main"),$("img").photoPicker({thumbnails:b})})}.call(this),define("main",function(){})